<!DOCTYPE html>
<html>
<head>
    <title>PricesAPI Test - Correct Format</title>
</head>
<body>
    <h1>PricesAPI.io Test (Job-Based API)</h1>
    <input type="text" id="productName" value="iPhone 17 Pro Max" style="width: 300px; padding: 5px;">
    <button onclick="testAPI()">Test API</button>
    <pre id="output" style="background: #f5f5f5; padding: 15px; border-radius: 5px;"></pre>

    <script>
        const API_KEY = '6915393b67msh53d3dc15a192ddep1fbc58jsnbeeed16e35f8';
        const API_HOST = 'real-time-product-search.p.rapidapi.com';
        const API_ENDPOINT = 'https://real-time-product-search.p.rapidapi.com';

        function log(message) {
            const output = document.getElementById('output');
            output.textContent += message + '\n';
            console.log(message);
        }

        async function testAPI() {
            document.getElementById('output').textContent = '';
            log('Testing RapidAPI Product Search...\n');
            
            const productName = document.getElementById('productName').value;
            const searchUrl = `${API_ENDPOINT}/search?q=${encodeURIComponent(productName)}&country=in&limit=10`;
            
            log('Product: ' + productName);
            log('URL: ' + searchUrl);
            log('Method: GET\n');
            
            try {
                log('Sending request...');
                const response = await fetch(searchUrl, {
                    method: 'GET',
                    headers: {
                        'X-RapidAPI-Key': API_KEY,
                        'X-RapidAPI-Host': API_HOST,
                        'Accept': 'application/json'
                    }
                });
                
                log('Status: ' + response.status + '\n');
                
                if (!response.ok) {
                    const errorText = await response.text();
                    log('❌ Error Response:\n' + errorText);
                    return;
                }
                
                const data = await response.json();
                log('✅ Response received!\n');
                log('Full Response:\n' + JSON.stringify(data, null, 2) + '\n');
                
                // Parse results
                if (data && data.data) {
                    const results = data.data;
                    log('━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');
                    log('Found ' + results.length + ' products:\n');
                    
                    results.slice(0, 5).forEach((result, i) => {
                        log(`Product ${i + 1}:`);
                        log('  Title: ' + (result.product_title || 'N/A'));
                        log('  Price: ' + (result.offer?.price || 'N/A'));
                        log('  Store: ' + (result.offer?.store_name || 'N/A'));
                        log('  Link: ' + (result.product_page_url || 'N/A'));
                        log('  Rating: ' + (result.product_star_rating || 'N/A'));
                        log('');
                    });
                } else {
                    log('❌ No data found in response');
                }
            } catch (error) {
                log('❌ Error: ' + error.message);
                log('Stack: ' + error.stack);
            }
        }
    </script>
</body>
</html>
